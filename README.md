# Курсовая работа «Резервное копирование»

Программа сохраняет фотографии из ВКонтакте на Яндекс Диск. 

Логика программы реализована в модуле `vk_backup`, который 
содержит класс `VKBackup` с единственным методом `backup`.

Модель `vk_backup` также содержит два вспомогательных 
подмодуля, `vk_client` и `yd_client`, которые предоставляют
простые классы клиентов для API ВКонтакте и API Яндекс Диска.

## Тестирование

В папке `tests` находятся юнит-тесты для подмодулей 
`vk_client` и `yd_client`. Для тестирования используется 
`pytest`.

Юнит-тестов для основного модуля нет, поскольку я не очень
представляю себе, как это можно реализовать. Вместо этого
в корне проекта находится файл `main.py`, в котором содержатся
несколько тестовых вызовов метода `VKBackup::backup()`.

## Доступ к API

Как юнит-тесты, так и `main.py` используют токены доступа,
сохранённые в корневом файле `tokens.json`. По соображениям 
безопасности мои токены вырезаны из репозитория, поэтому перед
тестированием проекта нужно добавить актуальные токены доступа
в `tokens.json`.

## Логирование

Я знаю, что есть стандартный модуль `logging` и всякие 
сторонние модули для красивых прогресс-баров и прочего, но я 
ещё не наигрался, поэтому мне было интересно сделать свой 
простой логгер, который выводит разноцветный текст в консоль
(стандартные варианты `info`, `success`, `warning` и `error`).

Этот логгер реализован в файле `vk_backup/logger.py`, и метод
`VKBackup::backup()` использует его для вывода сообщений в
консоль.

# Особенности бизнес-логики

Я старался сделать метод `VKBackup::backup()` максимально 
гибким. Он поддерживает все параметры для отбора фотографий,
которые описаны в https://dev.vk.com/ru/method/photos.get
(параметр `photos_params`). Помимо этого, можно задать папку
на Яндекс Диске, куда будут сохранены фотографии (параметр
`folder`), указать флаг перезаписи файлов на Яндекс Диске 
(параметр `overwrite`) и локальную папку, куда будет сохранен
JSON-результат работы метода (параметр `json_folder`).

По умолчанию, отбираются фотографии из альбома `profile` в
количестве не более 5 штук. Папка, в которую будут сохранены 
фотографии на Яндекс Диске, по умолчанию называется 
`VK Photos (Y-m-d)` (для текущей даты), а локальная папка для
результата работы метода &mdash; `output`. 

Файлы с результатами работы метода именуются по шаблону
`backup-{timestamp}.json` и сохраняются не только локально, но
и на Яндекс Диск в папку с только что загруженными 
фотографиями (на всякий случай).

Также стоит отметить, что в API Яндекс Диска оказался 
[метод](https://yandex.ru/dev/disk-api/doc/ru/reference/upload-ext)
для загрузки файлов по URL, и в реальной жизни для резервного
копирования я бы использовал его, потому что все фото 
ВКонтакте всё равно доступны по прямым URL, но, во-первых, я 
не сразу заметил этот метод, а во-вторых, мне кажется, что
в этой работе предполагалась как раз скачивание-закачивание
файлов, так что мой класс VKBackup делает под капотом именно
это: по одной скачивает фотографии из ВКонтакте и сразу же 
закачивает их на Яндекс Диск.
